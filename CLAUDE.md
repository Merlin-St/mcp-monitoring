# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a **financial system resilience monitoring tool** that analyzes MCP (Model Control Protocol) servers from the Smithery Registry to identify AI-related risks in financial systems. The project consists of data collection, analysis, and visualization components.

## Core Architecture

**Data Flow:**
1. **Collection**: `run_bulk_mcp_download.py` → API calls via `mcp_api_handler.py` → JSON data files
2. **Analysis**: `local_mcp_analysis.py` processes server data with financial risk categorization
3. **Visualization**: `local_mcp_dashboard.py` provides Streamlit web interface

**Key Configuration**: `bulk_mcp_config.py` contains API settings, financial sector keywords, and AI threat model definitions.

## Common Commands

### Data Collection
```bash
# Download all MCP server data from Smithery Registry
python run_bulk_mcp_download.py
```

### Data Analysis
```bash
# Run analysis on collected data
python local_mcp_analysis.py

# Quick data validation check
python quickcheck_bulk_mcp_data.py
```

### Web Dashboard
```bash
# Launch Streamlit dashboard
streamlit run local_mcp_dashboard.py
```

## Key Dependencies

**Required Python Libraries:**
- `requests` - API interactions
- `pandas` - data manipulation
- `streamlit` - web dashboard
- `plotly` - visualizations
- `nltk` - text processing (auto-downloads required data)

**API Authentication:**
- Smithery API token must be available at `~/.cache/smithery-api/token`
- Token is automatically read by the configuration system

## Data Files

- `all_mcp_server_summaries.json` - MCP server summary data (input for analysis)
- `all_mcp_server_details_complete.json` - Full server details (generated by bulk download)
- `bulk_mcp_download.log` - Download process logs

## Financial Risk Analysis

The system categorizes servers by:
- **Finance Sectors**: Banking, Trading, Insurance, Payments
- **AI Threat Models**: 10 categories including oversight correlation risk, trading algorithm bugs, AI-enhanced cyberattacks
- **Affordances**: Execution capabilities, information gathering, agent interactions

## Known Issues

- `mcp_api_handler.py:4` has broken import: `from hf_models_monitoring_test.config_utils` - this module path needs to be updated
- No formal testing framework - validation is done through `quickcheck_bulk_mcp_data.py` and built-in test execution in analysis scripts